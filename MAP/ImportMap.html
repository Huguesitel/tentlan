<html>
  <head></head>
  <body>

    <script>

      
      
      
      
      
      
 //     var params = {
        // The ID of the spreadsheet to retrieve data from.

       
         document.getElementById("demo").innerHTML ="OK 2"
        document.getElementById("demo2").innerHTML = JSON.parse(response.result)
        document.getElementById("demo3").innerHTML = response.result        

function initClient() {
      var API_KEY = 'AIzaSyCvKvYqIM_3KXaZgS99kUM7S2ITHTD4vgs';  // TODO: Update placeholder with desired API key.

      var CLIENT_ID = '30228964071-rh0keoh6eombsi4hpq8tspg2n0fiokek.apps.googleusercontent.com';  // TODO: Update placeholder with desired client ID.
  
//      var SCOPE = 'https://www.googleapis.com/auth/spreadsheets.readonly';

      gapi.client.init({
        'apiKey': API_KEY,
        'clientId': CLIENT_ID,
        'scope': SCOPE,
        'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
      }).then(function() {
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSignInStatus);
        updateSignInStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      });
    }

    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function updateSignInStatus(isSignedIn) {
      if (isSignedIn) {
        makeApiCall();
      }
    }

    function handleSignInClick(event) {
      gapi.auth2.getAuthInstance().signIn();
    }

    function handleSignOutClick(event) {
      gapi.auth2.getAuthInstance().signOut();
    }


/**
 * Print a file's metadata.
 *
 * @param {String} fileId ID of the file to print metadata for.
 */
function printFile(fileId) {
  var request = gapi.client.drive.files.get({
    'fileId': fileId
  });
  request.execute(function(resp) {
    console.log('Title: ' + resp.title);
    console.log('Description: ' + resp.description);
    console.log('MIME type: ' + resp.mimeType);
  });
}

/**
 * Download a file's content.
 *
 * @param {File} file Drive File instance.
 * @param {Function} callback Function to call when the request is complete.
 */
function downloadFile(file, callback) {
  if (file.downloadUrl) {
    var accessToken = gapi.auth.getToken().access_token;
    var xhr = new XMLHttpRequest();
    xhr.open('GET', file.downloadUrl);
    xhr.setRequestHeader('Authorization', 'Bearer ' + accessToken);
    xhr.onload = function() {
      callback(xhr.responseText);
    };
    xhr.onerror = function() {
      callback(null);
    };
    xhr.send();
  } else {
    callback(null);
  }
}

//https://drive.google.com/file/d/1dm0UwvieNroVWTH8rKmvtk0AWYkbWTvY/view?usp=sharing

    </script> 
    
    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
    <Div id ="demo">Test 11</Div>
     <Div id ="demo1">Test</Div>   
    <Div id ="demo2">Test</Div>   
    
    <button id="API call-button" onclick="function printFile(1dm0UwvieNroVWTH8rKmvtk0AWYkbWTvY)">API call-button</button>
    <button id="signin-button" onclick="handleSignInClick()">Sign in</button>
    <button id="signout-button" onclick="handleSignOutClick()">Sign out</button>
  </body>
</html>
